<!DOCTYPE html>
<html lang="zh-Hant-TW">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <title>2014年不動產地圖｜國民黨黨產揭露網</title>
  <link href="css/style.css" rel="stylesheet" type="text/css">
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script src="js/custor.js"></script>
</head>

<body>
  <div id="all-wrap">
    <header class="header-banner inner-header">
      <div>
        <h1>2014年不動產地圖</h1>
      </div>
    </header>
    <nav>
      <div id="nav-block">
        <span class="toggle">選單</span>
        <ul id="navbar-nav">
          <li><a href="index.html">首頁</a></li>
          <li><a href="property.html">資產一覽</a></li>
          <li><a href="estate.html">不動產</a></li>
          <li><a href="company.html">投資</a></li>
          <li><a href="organize.html">附隨組織</a></li>
          <li><a href="about.html">關於</a></li>
        </ul>
      </div>
    </nav>
    <div style="width:100%; height:100%; position: absolute;" >
      <div id="map-canvas" style="width:100%; height:100%; position: absolute;" ></div>
      <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
      <!-- Bootstrap Core JavaScript -->
      <script src="js/bootstrap.min.js"></script>
      <!-- Custom Theme JavaScript -->
      <script src="https://maps.googleapis.com/maps/api/js"></script>
      <script>
      var map;
      var cachedGeoJson;
      var infoWindow = new google.maps.InfoWindow({
        content: ""
      });

      function properties_to_html(properties) {
        var string = '<div style="line-height:1.35;overflow:hidden;white-space:nowrap;">';
        for (k in properties) {
          string = string + "<p>" + k + ": " + properties[k] + "</p>";
        }
        string = string + "</div>";
        return string;
      }

      function initialize() {
        var mapCanvas = document.getElementById('map-canvas');
        var mapOptions = {
          center: new google.maps.LatLng(23.69781, 120.96051499999999),
          zoom: 8,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        }
        map = new google.maps.Map(mapCanvas, mapOptions);
        var promise = $.getJSON("/data/2014_estate.geojson");
        promise.then(function(data) {
          cachedGeoJson = data;
          map.data.addGeoJson(cachedGeoJson);
        });
        map.data.addListener('click', function(event) {
          infoWindow.setContent(properties_to_html(event.feature.k));
          var anchor = new google.maps.MVCObject();
          anchor.set("position", event.latLng);
          infoWindow.open(map, anchor);
        });
      }
      google.maps.event.addDomListener(window, 'load', initialize);
      </script>
    </div>
  </div>
</body>

</html>
